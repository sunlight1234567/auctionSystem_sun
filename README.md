# 在线拍卖系统 (Online Auction System)

基于 Flask + Socket.IO + MySQL 构建的实时在线拍卖平台。支持实时竞价、即时通讯、订单支付模拟及完善的后台管理功能。

## ✨ 主要功能

*   **实时竞价**：基于 WebSocket 的毫秒级报价同步，支持防狙击机制（最后3分钟出价自动延时）及防连续出价。
*   **用户角色**：
    *   **管理员**：审核拍品、管理用户、查看系统数据。
    *   **卖家**：发布拍品、管理草稿、查看销售记录及买家收货信息。
    *   **买家**：浏览搜素、参与竞拍、中标支付、即时通讯。
*   **即时通讯**：买卖双方可进行私信沟通，支持未读消息红点提醒。
*   **支付与物流**：
    *   中标后生成模拟支付二维码（微信/支付宝）。
    *   支付超时自动惩罚机制（24小时未付封禁30天）。
    *   发货地址录入与同步。
*   **通知系统**：全站实时 Toast 通知（中标/流拍/新消息/审核结果）。
*   **个性化**：用户头像上传、个人动态发布、加价幅度自定义。

## 🛠️ 环境准备

1.  **Python 3.8+**
2.  **MySQL 8.0+**
3.  **浏览器**：推荐 Chrome/Edge (支持现代 WebSocket)

## 🚀 安装部署指南

### 1. 数据库配置
在 MySQL 中创建一个空的数据库，命名为 `Auction`：
```sql
CREATE DATABASE Auction DEFAULT CHARACTER SET utf8mb4;
```
*注：系统启动时会自动创建所需的数据表结构。*

### 2. 项目配置
打开 `app.py`，确认数据库连接配置（根据你的实际 MySQL 账号密码修改）：
```python
# app.py
app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://root:123456@localhost/Auction'
```

### 3. 环境安装
```bash
# 创建虚拟环境 (可选但推荐)
python -m venv venv
# 激活环境 (Windows)
.\venv\Scripts\activate

# 安装依赖项 (包含 Flask, Flask-SocketIO, PyMySQL, qrcode 等)
pip install -r requirements.txt
pip install qrcode[pil]
```

### 4. 启动系统
```bash
python app.py
```
终端显示 `Running on http://0.0.0.0:5000` 即表示启动成功。

*首次启动时，系统会自动创建一个默认管理员账号：*
*   用户名：`admin`
*   密码：`123`

## 📖 使用手册

### 访问
打开浏览器访问：`http://127.0.0.1:5000`

### 典型测试流程
1.  **管理员审核**：登录 `admin`，进入后台查看待审核列表。
2.  **卖家发布**：注册账户（角色选卖家），发布一个新拍品（可设置起拍价、加价幅度、时长）。
3.  **商品审核**：切回管理员账号，批准该商品上架。
4.  **买家竞拍**：注册两个不同的买家账号（建议使用隐私窗口或不同浏览器），对同一商品进行竞价，体验实时刷新和即时通知。
5.  **成交流程**：
    *   竞拍结束（时间到）。
    *   中标者收到绿色通知，点击详情页“立即支付”，填写地址并扫码（模拟）。
    *   支付成功后，卖家收到发货通知。
6.  **违约测试**：修改系统时间或结束条件，测试24小时未付款被自动封禁的功能。

## 🌐 局域网访问 (手机/其他电脑)

1.  **获取本机 IP**：终端运行 `ipconfig`，找到 IPv4 地址（如 `192.168.1.5`）。
2.  **防火墙设置**：确保 Windows 防火墙允许 Python 程序通过公共/专用网络。
3.  **访问**：在同一 Wi-Fi 下的设备浏览器输入 `http://192.168.1.5:5000`。

## ⚠️ 注意事项
*   本系统支付功能仅为逻辑模拟，生成的二维码不产生实际扣款。
*   请确保 MySQL 服务已启动且 `app.py` 中的连接字符串正确。
